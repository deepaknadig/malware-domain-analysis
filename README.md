# Analyzing malicious URLs : A machine learning approach

In this project, we focus on analyzing a malicious URL dataset collected by threat intelligence feeds framework. We implement a machine-learning approach to reduce the reliance on Network intrusion detection sysetm (NIDS) and to detect actual malicious activities in the network traffic based on known URL patterns. In this project, we design a machine learning technique for intelligent detection of malicious behavior in threat data as applicable to real-world problems such as reducing false positive alarms in the data center. We analyze up-to-date threat information from well-known network intrusion detection systems and threat intelligence systems. We use an unsupervised learning technique to analyze malicious URLs. 

First, we convert the text data to vectors using Term frequency-inverse document frequency (TF-IDF). We then use the k-means clustering algorithm for URL keyword clustering and determine the optimal number of clusters using the Elbow method. 
Next, we evaluate the quality of clusters by using Silhouette analysis. Through our analysis, we identify if there are any commonalities between keywords in each cluster with a test dataset of 500 URLs. We find the top terms in each cluster using the TF-IDF score across the clusters and design a probabilistic model by comparing the resulting keyword with a test set to verify malicious behavior.


The src folder includes all source code in jupyter notebook. For clusters result please refer to K-Means clustering.ipynb file. For silhouette plot also please refer K-Means clustering.ipynb file.
For Elbow method plot please refer Elbow Method.ipynb. I plot the Elbow graph for different iteration. This file shows the Elbow plot for 1000 iterationS. For measuring the frequency of malicious keywords in the testing set, please refer the jupyter notebook named Probabilistic model.ipynb. In this first, I parse the new set of URLs, then make an array of clusters keywords. The visualization folder contains visualization for clusters, result analysis plot, elbow plot and silhouette analysis plot. The System Design folders contain flow chart for this project, picture of the threat intelligence system and elasticsearch.
